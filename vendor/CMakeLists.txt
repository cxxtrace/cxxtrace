cmake_minimum_required(VERSION 3.10)

set(BENCHMARK_DOWNLOAD_DEPENDENCIES FALSE CACHE INTERNAL "")
set(BENCHMARK_ENABLE_ASSEMBLY_TESTS FALSE CACHE INTERNAL "")
set(BENCHMARK_ENABLE_EXCEPTIONS TRUE CACHE INTERNAL "")
set(BENCHMARK_ENABLE_GTEST_TESTS FALSE CACHE INTERNAL "")
set(BENCHMARK_ENABLE_INSTALL FALSE CACHE INTERNAL "")
set(BENCHMARK_ENABLE_LTO "${CMAKE_INTERPROCEDURAL_OPTIMIZATION}" CACHE INTERNAL "")
set(BENCHMARK_ENABLE_TESTING FALSE CACHE INTERNAL "")
add_subdirectory(benchmark)

set(BUILD_GMOCK TRUE CACHE INTERNAL "")
set(INSTALL_GTEST FALSE)
set(gmock_build_tests FALSE CACHE INTERNAL "")
add_subdirectory(googletest)

add_library(relacy INTERFACE)
target_include_directories(relacy INTERFACE relacy)
if (APPLE)
  # Allow including <ucontext.h>, and fix the definition of ucontext_t.
  target_compile_definitions(relacy INTERFACE _XOPEN_SOURCE=700)
endif ()
